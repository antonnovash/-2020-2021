\chapter{ОБЗОР ЛИТЕРАТУРЫ}
В настоящей глава формулируются основные понятия и определения, используемые в курсовой работе. Приводится классификация (согласно работе \cite{GabasovKirillovaPU}) принципов управления, используемых в современной теории управления. Объясняется принцип управления в режиме реального времени в применении к реализации оптимальных обратных связей в задачах оптимального управления с конечным горизонтом планирования \cite{GabasovDmitrukKirillova15a}.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Понятие управления}
Человек занимается управлением на протяжении всей своей жизни для обеспечения желаемого течения тех или иных процессов или сам предпринимает необходимые действия и принимает соответствующее решения.

Теория оптимального управления, отражающая современный этап развития вариационного исчисления, возникла в середине XX века в связи с задачами, поставленными практикой в различных областях развития новой техники.

Существует два взгляда на теорию оптимального управления. Согласно одному из них, теория оптимального управления --- раздел современного вариационного исчисления. В соответствии с этим взглядом можно предложить следующее определение термина "управление":
Управления --- элементы функциональных пространств, по которым ищется экстремум выбранного функционала качества. Главной задачей данной теории является анализ решения экстремальной задачи (существование, единственность, непрерывная зависимость решений, необходимые и достаточные условия оптимальности).

Другой взгляд трактует данную теорию как раздел современной теории управления, представляющей естественное развитие классической теории управления. В этом случае выделим следующее определение для термина "управление": Управления --- это процесс, в котором для достижения нужного поведения объекта управления в каждый текущий момент времени создаются целенаправленные (управляющие) воздействия на объект управления в зависимости от доступной к этому моменту информации о поведении объекта и действующих на него возмущений.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Принципы управления}\label{1sec:Solution}

При управлении динамическим объектом используются три принципа: управление по разомкнутому контуру (программное управление рис. 1.1), управление по замкнутому контуру (позиционное управление рис 1.2), управление в реальном времени.


\begin{figure}[h]
\begin{center}
\begin{minipage}[h]{0.45\linewidth}
\includegraphics[width=1\linewidth]{image1.1.jpg}
\caption{а) разомкнутый контур;}
\label{ris:experimoriginal} %% метка рисунка для ссылки на него
\end{minipage}
\hfill
\begin{minipage}[h]{0.45\linewidth}
\includegraphics[width=1\linewidth]{image1.2.jpg}
\caption{б) замкнутый контур;}
\label{ris:experimcoded}
\end{minipage}
\end{center}
\end{figure}

\begin{definition}
Программное управление --- управление, при котором (программные) управляющие воздействия (программы) планируются по априорной информации до начала процесса управления и не корректируются в процессе управления.
\end{definition}

Программное управление редко применяется на практике, поскольку не учитывает неточности математического моделирования физических систем и возмущения, косвенная информация о которых доступна, как правило, в процессе управления. Фундаментом этого метода является принцип максимума Понтрягина \cite{Pontryagin}.

\begin{definition}
Позиционное управление --- управление, при котором (позиционные) управляющие воздействия создаются в процессе управления по текущим позициям, которые аккумулируют информацию, доступную к текущему моменту.
\end{definition}

Динамическое программирование \cite{Bellman} является одним из основных методов реализации позиционного управления.

\begin{definition}
Cинтез оптимальных систем управления --- построение оптимальных позиционных управляющих воздействий.
\end{definition}

При создании систем по принципу замкнутого контура используются связи трех типов:\emph{прямые}, \emph{обратные} и \emph{комбинированные} (рис. 1.2).
\begin{figure}[h]

\centering

\includegraphics[width=\linewidth]{image2.jpg}

\caption{а) обратная связь; б) прямая связь; в) комбинированная связь}

\end{figure}

Связь называется прямой, если она преобразует в управляющее воздействие доступную информацию о наблюдаемых входных сигналах. Обратная связь по состоянию преобразует в управляющее воздействие информацию о состоянии объекта. В комбинированной связи преобразуется информация обоих типов.

Для позиционного управления характерна следующая особенность. Проблема синтеза в рамках принципа управления по замкнутому контуру не удается решить из-за проклятия размерности ни с помощью принципа максимума \cite{Pontryagin}, ни с помощью динамического программирования Беллмана \cite{Bellman}.

Решение данной проблемы можно предложить, если  перейти к современному принципу управления --- оптимальному управлению в реальном времени \cite{GabasovDmitrukKirillova15a}. При управлении динамическим объектом в реальном времени связи не строятся, а необходимые для управления их текущие значения формируются в реальном времени по ходу каждого конкретного процесса.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Реализация оптимальных обратных связей в реальном времени}
Принцип управления в реальном времени и подход к реализации оптимальной обратной связи в реальном времени опишем на примере следующей задачи оптимального управления.

\begin{equation} \label{1problem}
    c^Tx(t_f)\to \min,
    \end{equation}
$$
    \dot{x}=A(t)x+B(t)u,\quad x(t_0)=x_0^*,
    $$
$$
    x(t_f) \in X_f,\quad  u(t)\in U, \quad  t\in T = [t_*, t^*],
    $$
где  $x = x(t)\in \mathbb{R}^n$ --- состояние модели управления в момент времени $t$,
$u = u(t)\in \mathbb{R}^r$ --- значение управляющего воздействия в момент $t$,
$A(t)\in \mathbb{R}^{n\times n}$,
$B(t)\in \mathbb{R}^{n\times r}$,
$x_0^*$ --- известное начальное состояние объекта.
$X_f=\{x\in \mathbb{R}^n: g_*\leq Hx + Gu \leq g^*\}$ --- терминальное
множество, $H\in \mathbb{R}^{m\times n}$, $g_*,$ $g^* \in \mathbb{R}^m$;
$U=\{u\in \mathbb{R}^r: u_*\le u\le u^*\}$ --- множество доступных значений
управляющего воздействия.

\begin{definition}  Управляющее воздействие $u(t)\in U$, $t\in T$, называется программой, если соответствующая ему
траектория $x(t)$, $t\in T$, математической модели (\ref{1problem}) удовлетворяет
условию $x(t_f)\in X_f$.
\end{definition}

\begin{definition}  Программа $u^0(t)$, $t\in T$,
называется оптимальной (программным решением задачи (\ref{1problem})), если на соответствующей ей (оптимальной) траектории $x^0(t)$, $t\in T$, выполняется равенство $c^Tx^0(t_f) = \min_u c^Tx(t_f),$ где минимум ищется среди всех программ.
\end{definition}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Задача (\ref{1problem}) рассматривается в классе дискретных управляющих воздействий:
$$
u\equiv u(\tau), t\in [ \tau,\tau + h[, \ \tau = T_h = \{t_0,t_0 + h,...,t_f - h\},
$$
где  $h = (t^* - t_*)/N$ --- период квантования, $N>1$ --- натуральное число.

Чтобы ввести понятие классической оптимальной обратной связи, погрузим задачу (\ref{1problem}) в семейство задач
\begin{equation} \label{2problem}
    c^Tx(t_f)\to \min,
    \end{equation}
$$
    \dot{x}=A(t)x+B(t)u,\quad  x(\tau) = z,
    $$
$$
    x(t_f) \in X_f,\quad  u(t)\in U, \quad  t\in T(\tau) = [\tau, t_f],
    $$
зависящее от скаляра $\tau \in T_h$ и $n$-вектора $z$.
Пару $(\tau,z)$ назовём позицией системы управления.
Пусть $u^0(t|\tau,z),\quad t\in T(\tau),$ — оптимальная программа задачи (\ref{2problem}) для позиции ($\tau$,z).

\begin{definition}
Функция
\begin{equation} \label{3problem}
    u^0(\tau,z) = u^0(\tau|\tau,z),\quad z\in X_\tau,\quad \tau \in T_h,
    \end{equation}
называется оптимальной обратной связью (позиционным решением задачи (\ref{1problem})).
\end{definition}

Оптимальная обратная связь (\ref{3problem}) строится по детерминированной математической модели, но предназначена для управления физическим объектом, поведение которого, как правило, отличается от идеальной модели. Пусть поведение замкнутого обратной связью объекта  управления описывается дифференциальным уравнением
\begin{equation} \label{4problem}
\dot{x}=A(t)x+B(t)u^0(t,x) + w(t),\ x(t_0) = x_0,
 \end{equation}
где $u^0(t,x) = u^0(t,x(t)) \equiv u^0(\tau,x(\tau))$, $t\in [\tau,\tau + h[$, $\tau\in T_h$, $w(t)$, $t\in T$, --- возмущение, действующее на физический объект в процессе управления.

Рассмотрим поведение системы (\ref{4problem}) в конкретном процессе управления. Конкретный процесс характеризуется конкретным реализовавшимся возмущением $w^*(t)$, $t\in T$. Тогда в нем реализуется траектория $x^*(t)$, $t\in T$:
$$
    \dot{x}^*(t)=A(t)x^*(t)+B(t)u^0(t,x^*(t)) + \omega^*(t),\quad x^*(t_0) = x_0.
    $$
Отсюда следует, что в конкретном процессе управления оптимальная обратная связь (\ref{3problem}) не используется целиком, нужны лишь её следующие значения:
\begin{equation}\label{u}
    u^*(t)\equiv u^*(\tau) = u^0(\tau,x^*(\tau)) = u^0(\tau|\tau,x^*(\tau)),\quad t\in[\tau,\tau + h[,\quad  \tau \in T_h.
    \end{equation}

\begin{definition}
Функцию $u^*(t), t\in T$, определенную согласно (\ref{u}) будем называть реализацией оптимальной обратной связи (\ref{3problem}) в конкретном процессе управления.
\end{definition}


Перейдём к описанию принципа оптимального управления в реальном времени, при котором обратная связь  (\ref{3problem}) не строится, а при каждом $\tau \in T_h$ текущее управляющее воздействие (\ref{u}) создаётся в процессе управления для текущей позиции $(\tau,x^*(\tau))$.


Из определения оптимальной обратной связи следует, что  в каждый момент времени $\tau \in T_h$ должна решаться задача оптимального управления
\begin{equation} \label{5problem}
    c^Tx(t_f)\to \min,
    \end{equation}
$$
    \dot{x}=A(t)x+B(t)u,\quad x(\tau) = x^*(\tau),
    $$
$$
    x(t_f) \in X_f,\quad  u(t)\in U, \quad  t\in T(\tau).
    $$

Пусть  $\delta(\tau)$ — время решения задачи (\ref{5problem}).

\begin{definition}
Устройство, способное вычислять значение $u^*(\tau), \tau \in T_h$, за время $\delta(\tau) < h$, называется оптимальным регулятором, реализующим оптимальную обратную связь (\ref{3problem}) в реальном времени.
\end{definition}

Алгоритм работы оптимального регулятора состоит из $3$ шагов:

1. Получить измерение состояния $x^*(\tau)$.

2. Решить задачу оптимального управления (\ref{5problem}).

3. Подать управление на систему $u^*(\tau)$.

Продолжая этот процесс получим следующую последовательность состояний объекта:
$$x^*(t_0) = {x_0}^*, x^*(t_* + h),..., x^*(\tau),..., x(t_f),$$
и соответствующую ей последовательность управляющих воздействий:
$$u^*(t_0), u^*(t_0 + h),..., u^*(\tau),..., u^*(t_f - h).$$

\section{Численное решение задачи оптимального управления}
Для решения задачи (\ref{5problem}) можно использовать различные подходы. Простейшим будет сведение ее к задаче линейного программирования, что возможно благодаря выбору класса дискретных управляющих воздействий.

Для этого запишем формулу Коши для линейной системы:
\begin{equation} \label{1.7}
x(t_f) = F(t_f,\tau)x^*(\tau) + \int_{\tau}^{t_f} F(t_f,t)B(t)u(t) dt ,
\end{equation}
где $F(t_f,t)$ --- фундаментальная матрица, т.е. решение уравнения
$$
    \dot F(t_f,t) = - F(t_f,t)A(t),\quad F(t_f,t_f) = E.
    $$
Интеграл в правой часть равенства (\ref{1.7}) запишем следующим образом:
\begin{equation} \label{1.8}
x(t_f) = F(t_f,\tau)x^*(\tau) +  \sum_{s=\tau}^{t_f-h}\int_{s}^{s+h} F(t_f,t)B(t)\,dt \  u(s).
\end{equation}

Используя (\ref{1.8}) запишем левую часть терминального ограничения:

\begin{equation} \label{1.9}
Hx(t_f) = HF(t_f,\tau)x^*(\tau) +  \sum_{s=\tau}^{t_f-h}\int_{s}^{s+h} HF(t_f,t)B(t)\,dt\   u(s).
\end{equation}

Равенство  (\ref{1.9}) перепишем в виде:
$$
    Hx(t_f) = \Phi(\tau)x^*(\tau) +  \sum_{s=\tau}^{t_f-h}D(s)\ u(s).
    $$
где введены следующие обозначения:
$$
    \Phi(t) = HF(t_f,t) \quad \Phi(t_f) = H, \quad \dot{\Phi} = -\Phi A(t);
    $$
$$
    D(s) =\int_{s}^{s+h} \Phi(t)B(t)\,dt,\quad s\in T_h.
    $$

Таким образом, исходная задача (\ref{5problem}) эквивалентна следующей задаче линейного программирования:
\begin{equation} \label{9problem}
\sum_{t\in T_h(\tau)}^{}c'(t)u(t) \to \min,
\end{equation}
$$g_*(\tau) \leq \sum_{s\in T_h(\tau)}^{}D(s)u(s) \leq g^*(\tau),$$
$$
    u_*\leq u(t) \leq u^*,\quad t \in T_h(\tau),
$$
где
$$
    c'(t) = \int_{s}^{s+h} F(t_f,t)B(t)\,dt,\quad s\in T_h,
    $$
$$
    g_*(\tau) = g_* - \Phi(\tau)x^*(\tau),
    $$
$$
     g^*(\tau) = g^* - \Phi(\tau)x^*(\tau).
    $$

Задача (\ref{9problem}) называется функциональной формой задачи оптимального управления (\ref{5problem}). На ее основе в литературе \cite{Dmitruk08a} предложена динамическая реализация специального двойственного метода линейного программирования \cite{GabasovDmitrukKirillova15a}, основанная на близости задач оптимального управления (\ref{5problem}) для соседних моментов $\tau$ и $\tau+h$.

\section{Управление системой с возмущением}

Будем рассматривать задачу оптимального управления линейной динамической системой с возмущениями и смешанными ограничениями:
\begin{equation} \label{10}
    \max\limits_{u}\min\limits_{w} c'x(T),
\end{equation}
$$
    \dot{x}=Ax(t) + Bu(t) + Mw(t), x(0) = x_0, u(t)\in U, t\in [0, T],
    $$
$$
    Hx(t) + Gu(t)\leq g, \forall w(t)\in W,  t\in [0, T].
    $$
Здесь $x(t) \in \mathbb{R}^n$ — состояние, $u(t) \in \mathbb{R}^r$ — управление, $w(t) \in \mathbb{R}^p$, $A \in \mathbb{R}^{n\times n}, B \in \mathbb{R}^{n\times r}, M \in \mathbb{R}^{n\times p}, H \in \mathbb{R}^{m\times n}, G\in \mathbb{R}^{m\times r},$ — заданные матрицы; $U \subset \mathbb{R}^r$, $W \subset \mathbb{R}^p$ — выпуклые компакты, множества доступных значений управления и возможных значений возмущения. С целью упрощения выкладок считаем, что $W$ — гиперкуб: $W = \left\{ {w \in \mathbb{R}^p: {\|w\|}_\infty} \leq w_{\max} \right\}$, где $0 < w_{\max} < +\infty$, ${\|w\|}_\infty = \max\limits_{k = \overline{1,p}}  |w_k|$ – равномерная норма. Рассматриваемый тип неопределенности в литературе называется множественной неопределенностью \cite{KirillovaGabasovDmitruk}.


В задаче (\ref{10}) требуется выполнить ограничения $Hx(t) + Gu(t)\leq g$  при всех возможных возмущениях. В таких случаях говорят, что ограничение выполняется с гарантией. При этом требуется найти гарантированное значение критерия качества --- стоимость $c'x(T)$ при наихудшей реализации возмущения. Дадим определения.

\begin{definition} Кусочно-непрерывная функция $u(t) \in U$, $ t\in [0, T]$, называется \textit{гарантирующей программой управления} в задаче (\ref{10}), если при любой возможной реализации возмущения $w(t)\in W$, $t\in [0, T]$ выполнено ограничение $Hx(t) + Gu(t)\leq g$, $t\in [0, T]$.
\end{definition}

\begin{definition} Гарантирующая программа $u^0(t)$, $t\in [0, T]$,
называется \textit{оптимальной} в задаче (\ref{10}), если $u^0(\cdot) = \arg\max\limits_{u}\min\limits_{w} c'x(T)$.
\end{definition}

Будем считать, что для целей управления доступны полные и точные измерения состояний, которые поступают в дискретные моменты времени  $\tau \in \Delta \to T_h$. Траекторию измерений в конкретном процессе управления будем обозначать $x^*(\tau)$, $\tau \in \Delta$; она зависит от $u^*(\cdot)$, $w^*(\cdot)$ --- выбранного управления и реализовавшегося возмущения.

При сделанном предположении определим понятие (дискретной) оптимальной обратной связи в задаче (\ref{10}). Для этого погрузим ее в семейство задач оптимального управления
\begin{equation} \label{11}
    \max\limits_{u}\min\limits_{w} c'x(T)
\end{equation}
$$ \dot{x}=Ax(t) + Bu(t) + Mw(t), x(\tau) = z, u(t)\in U, t\in [\tau, T],
    $$
$$
    Hx(t) + Gu(t)\leq g, \forall w(t)\in W,  t\in [\tau, T].
    $$
зависящее от пары $(\tau, z)$, $\tau \in \Delta$, $z \in \mathbb{R}^n$ которая называется позицией процесса управления.

Пусть $u^0(t|\tau, z)$, $t \in [\tau, T]$, – оптимальная гарантирующая программа управления в задаче (\ref{11}) для позиции $(\tau, z)$, $X(\tau)$ – множество всех состояний $z$, для которых в заданный момент $\tau$ оптимальная гарантирующая программа существует.

\begin{definition} Функция $u^0(\tau, z) = u^0(\tau | \tau, z)$, $z \in X(\tau)$, $\tau \in \Delta$, называется \textit{(дискретной) оптимальной обратной связью} в задаче (\ref{10}).
\end{definition}

Для задач оптимального управления с конечным горизонтом управления (как в задаче (\ref{10})) подход носит название \textit{управления в реальном времени} (см. \cite{KirillovaGabasovDmitruk} и ссылки в ней). Для задач стабилизации, регулирования и др. подход широко известен как \textit{управление по прогнозирующей модели} (Model Predictive Control), имеет обширную практику применения и глубокие теоретические результаты \cite{RawlingsMayne,GrunePannek}. Оба подхода получили развитие на децентрализованное (распределенное) управление для отдельных классов динамических систем \cite{Christofides,DmitrukRobust,GabasovDmitrukKirillova}.

Далее опишем подход к построению в реальном времени реализации дискретной обратной связи при централизованном (разд.3) и децентрализованном (разд.4) управлении.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


Кратко остановимся на подходе к решению максиминной задачи (\ref{11}). Используя рассуждения, аналогичные работе \cite{KirillovaGabasovDmitruk}, задача (\ref{11}) может быть сведена к детерминированной задаче оптимального управления. В частности, для выполнения в момент времени $t$ с гарантией $l$-го смешанного ограничения $H_l{x(t)} + G_l{u(t)}\leq g_l$, где $H_l$, $G_l$ --- $l$-е строки матриц $H$, $G$, вычислим оценку наихудшей реализации возмущения

$$ \gamma_l(t)= \max\limits_{w}\int_{0}^{t} H_l e^{A(t-s)}Mw(s) ds = w_{\max}\int_{\tau}^{t}{\| H_le^{A(t-s)}M \|}_1 ds, $$
где ${\|z\|} _1 = \sum_k |z_k|$.

Тогда выполнение смешанных ограничения с гарантией эквивалентно выполнению для номинальной системы (системы без возмущения)
\begin{equation} \label{12}
    \dot{x}_0(t) = Ax_0(t) + Bu(t), x_0(\tau) = x^*(\tau).
\end{equation}
ограничения $Hx_0(t) + Gu(t) \leq g - \gamma(t - \tau)$, где $\gamma(t) = \left( \gamma_l(t), l = \overline{1,m} \right)$.

Аналогично оценивается гарантированное значение критерия качества:
\begin{equation} \label{12.1}
\min\limits_{w}c'x(T) = \gamma_0(\tau) + c'x_0(T),
\end{equation}
$$\gamma_0(\tau) = \min\limits_{w}\int_{\tau}^{T} c'e^{A(T-s)}Mw(s) ds = -w_{max}\int_{\tau}^{T} {\|c'\exp^{A(T-s)}M\|}_1 ds.$$
Таким образом, оптимальная гарантирующая программа задачи (\ref{11}) для позиции $(\tau, x^*(\tau))$ находится по решению детерминированной задачи оптимального управления

\begin{equation} \label{13}
    \max\limits_{u}c'x_0(T),
\end{equation}
$$\dot{x_0}(t) = Ax_0(t) + Bu(t), x_0(\tau) = x^*(\tau),
    $$
$$Hx_0(t) + Gu(t) \leq g - \gamma(t - \tau), u(t) \in U, t \in [\tau, T].
    $$

Численное решение задачи (\ref{13}) не представляет трудностей, поскольку она сводится к задаче выпуклого программирования (при произвольном выпуклом $U$) или линейного программирования (если $U$ – выпуклый многогранник).

Нетрудно видеть, что сужение оптимальной программы  $u^0(t| \tau, x^*(\tau - h))$, $t \in [\tau - h, T]$, на промежуток $[\tau, T]$ допустимо в задаче (\ref{13}) для позиции $(\tau, x^*(\tau))$. Отсюда следует два важных свойства описанного выше алгоритма централизованного управления:

1. (рекурсивная разрешимость) если задача (\ref{10}) (для начальной позиции $(0, x_0)$) имеет решение, то все последующие задачи (\ref{13}) для позиций $(\tau, x^*(\tau))$, также имеют решение;

2. (монотонность стоимости) оптимальное значение задачи (\ref{13}) для позиции $(\tau, x^*(\tau))$ не хуже оптимального значения задачи (\ref{13}) для предыдущей позиции $(\tau - h, x^*(\tau - h))$.

В настоящей глава были рассмотрены основные понятия и определения. Была описана классификация принципов управления, используемых в современной теории управления. Рассмотрен принцип управления в режиме реального времени в применении к реализации оптимальных обратных связей в задачах оптимального управления с конечным горизонтом планирования.
\bigskip 