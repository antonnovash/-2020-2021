\chapter{ОПТИМАЛЬНОЕ ЦЕНТРАЛИЗОВАННОЕ УПРАВЛЕНИЕ В ЭКОНОМИЧЕСКОЙ ЗАДАЧЕ}
В данной главе рассматривается формулировка задачи оптимального управления для модели расширяющейся экономики фон Неймана. Описываются особенности задачи. Рассматривается сведение задачи оптимального управления к задаче линейного программирования. Формулируется и решается линейная задача оптимального управления в реальном времени. Рассматривается алгоритм централизованного управления.

\section{Задача оптимального управления для модели расширяющейся экономики фон Неймана}
%\section{Построение программных решений}\label{1sec:program-solution}
Простой и наглядной задачей, с помощью которой можно
проиллюстрировать предлагаемый подход децентрализованного управления, является задача оптимального управления для модели расширяющейся экономики фон Неймана.
Данная модель ещё в 30-е годы была сформулирована Джоном фон Нейманом, который решил для ней задачу оптимизации многошаговых процессов в своеобразном классе допустимых управлений.

Рассмотрим замкнутую экономику, которая на промежутке времени $T = [0, z]$ производит $n$ типов товаров с использованием $r$ технологических процессов (ТП).

Технологический процесс $j$ при единичной интенсивности расходует товар $i$ в количестве ${a_i}_j$ и производит в количестве ${b_i}_j$, $i\in I ={1, ..., n}, j\in J ={1, ..., r}$.

Если за $x_i(t)$ принять количество $i$ -го товара, $u_j(t)$ — интенсивность $j$ -го ТП в момент $t$, $x(t) = (x_i(t), i\in I)$ — вектор товаров, $u(t) = (u_i(t), j \in J)$ — вектор интенсивностей ТП в момент t, $A = ({a_i}_j, i \in I, j \in J)\in \mathbb{R}^{n\times n}$,
$B = ({b_i}_j,i \in I, j \in J )\in \mathbb{R}^{n\times r}$ — матрицы затрат и выпуска, соответственно, $x_0$— $n$ - вектор начальных объёмов товаров, то непрерывная модель расширяющейся экономики описывается линейным дифференциальным уравнением
\begin{equation} \label{2.1}
\dot{x}= (B - A)u(t),\quad x(0) = x_0, \quad t\geq 0
\end{equation}
На переменные модели (\ref{2.1}) накладываются ограничения:
\begin{equation} \label{2.2}
Au(t)\leq x(t), u(t)\geq 0, t \geq 0,
\end{equation}
Ограничения (\ref{2.2}) связаны с невозможностью расходовать больше товара, чем имеется в наличии в каждый момент времени, а также необходимостью использовать неотрицательную интенсивность ТП.

Будем искать такой план производства, при котором в заданный момент $T$ стоимость товаров будет максимальной.
\begin{equation*}
c'x(T) = \sum_{i\in I}^{}{c_i}'x_i(T)
\end{equation*}
Здесь $c = (c_i, i\in I)$ – вектор цен.

Таким образом, задача оптимального управления системой (\ref{2.1}) имеет вид
\begin{equation} \label{2.4}
    J(u) = c'x(T)\to \max,
\end{equation}
$$
    \dot{x}=(B - A)u,\quad x(0) = x_0,
    $$
$$
    Au(t)\leq x(t),
    $$
$$
    u(t)\geq 0, \quad  t\in [0, T].
    $$

\section{Обсуждение особенностей задачи}
При практическом применении результатов теории управления необходимо учитывать следующие особенности:

1. Все реальные экономические объекты управления содержат неопределенности: возмущения, неточности математического моделирования, ошибки измерений и др. Например, модель (\ref{2.1}) может быть подвержена действию возмущений,
вызванных сбоями в работе ТП, их работой не на полную мощность, браком товаров.

2. При управлении в условиях неопределенности используются обратные связи. Их построение в явном виде для задач с ограничениями (как в (\ref{2.4})) в большинстве случаев невозможно, а применение результатов динамического программирования сдерживается "проклятием размерности" \cite{Bellman}.

3. Сложные системы управления часто имеют структуру, учет которой позволяет упростить или ускорить процедуры построения обратных связей. Важным примером системы со структурой являются так называемые мультиагентные системы \cite{Dmitruk14b}, для которых характерно применение децентрализованного управления: каждый "агент"\ управляется локально, но преследуется общая цель при общих ограничениях на состояния и управления.

В задаче (\ref{2.4}) также можно выделить структуру: она задается технологическими процессами. Соответственно, управление здесь можно организовать двумя способами:

1) Централизованно, когда один управляющий орган (регулятор) принимает решение для всех ТП одновременно.

2) Децентрализованно, когда для каждого ТП интенсивность выбирается относительно независимо, локальным управляющим органом (локальным регулятором).

Цель при децентрализованном управлении общая – максимизация гарантированной стоимости товаров, произведенных всеми процессами к моменту времени T , но все решения необходимо принимать локально, не нарушая при этом общих ограничений.

Далее в настоящей главе будет рассматриваться централизованное управление. Начнём с построения программного решения задачи, которая обобщает (\ref{2.4}).

\section{Построение программных решений}

Cформулируем задачу оптимального управления линейной динамической системы, на состояния и управления которой наложены смешанные ограничения с возмущением:

\begin{equation} \label{2.5}
    \max\limits_{u}\min\limits_{w} c'x(T),
\end{equation}
$$
    \dot{x}=Ax(t) + Bu(t) + Mw(t), x(0) = x_0, u(t)\in U, t\in [0, T],
    $$
$$
    Hx(t) + Gu(t)\leq g, \forall w(t)\in W,  t\in [0, T].
    $$
Здесь $x(t) \in \mathbb{R}^n$ — состояние, $u(t) \in \mathbb{R}^r$ — управление, $A \in \mathbb{R}^{n\times n}, B \in \mathbb{R}^{n\times r}, H \in \mathbb{R}^{n\times n}, G\in \mathbb{R}^{m\times r},$ — заданные матрицы; $U \subset \mathbb{R}^r$ ,$W \subset \mathbb{R}^p$ — выпуклые компакты.

Задача (\ref{2.5}) обобщает задачу (\ref{2.4}) для которой:
$$A = E, B = B - A, H = -E, G = A, g = 0.$$

Будем считать, что для целей управления доступны полные и точные измерения состояний, которые поступают в дискретные моменты времени $\tau \in T_h = {0, h, ..., T - h},$ где $h = T/N$ — период квантования.

Траекторию измерений в конкретном процессе управления будем обозначать $x^*(\tau), \tau \in T_h $; она зависит от $u^*(\cdot)$ выбранного управления.

Для решения задачи (\ref{2.5}) в классе дискретных управляющих воздействий сведём ее к задаче линейного программирования с помощью формулы Коши для линейной системы.

\begin{equation} \label{2.6}
x(t) = F(t,0)x_0 + \int_{0}^{t} F(t,\theta)Bu(\theta) dt ,
\end{equation}
где $F(t,\theta)$ --- фундаментальная матрица, т.е. решение уравнения
$$
    \dot F(t,\theta) = - F(t,\theta)A, \quad F(t,t) = E.
    $$
Решением данного уравнения является следующее значение $F(t,\theta)$:
$$F(t,\theta) = F(t - \theta) = e^{A(t - \theta)}.$$

Интеграл в правой часть равенства (\ref{2.6}) с учетом дискретности управления запишем следующим образом:
\begin{equation} \label{2.7}
x(t) = F(t,0)x_0 +  \sum_{s\in T_h(0, t)}^{}\int_{s}^{s+h} F(t,\theta)B\,d\theta \  u(s),
\end{equation}
где $T_h(0, t) = \{0, h, ..., t-h\}$.

Используя (\ref{2.7}) запишем левую часть терминального ограничения:

\begin{equation} \label{2.8}
Hx(t) + Gu(t) = HF(t,0)x_0 + \sum_{s \in T_h(0,t)}^{}\int_{s}^{s+h} HF(t,\theta)B\,d\theta \ u(s) + Gu(t).
\end{equation}

Введём следующие обозначения:
$$
    \Phi(t) = HF(t,0) =  He^{At}.
    $$
$$
    D(t, s) =\int_{s}^{s+h} \Phi(t - \theta)B\,d\theta,\quad s\in T_h(0,t).
    $$
$$ \gamma(t)= \max\limits_{w}\int_{0}^{t}\Phi(t - \theta)Mw(s) ds = w_{\max}\int_{0}^{t}{\|\Phi(t - \theta)M \|}_1 ds, $$
где ${\|z\|} _1 = \sum_k |z_k|$.
    
Равенство  (\ref{2.8}) перепишем в следующем виде:
$$
    Hx(t) + Gu(t)= \Phi(t)x_0 +  \sum_{s \in T_h(0, t)}^{}D(t, s)u(s) + Gu(t) + \gamma(t)
    $$


Таким образом, исходная задача (\ref{2.5}) эквивалентна следующей задаче линейного программирования:
\begin{equation} \label{2.9}
\sum_{t \in T_h}^{}c'(t)u(t) \to \min,
\end{equation}
$$ \sum_{s \in T_h(0, t)}^{}D(t,s)u(s) + Gu(t) \leq g^*, \quad t\in T_h,$$
$$
    u_*\leq u(s) \leq u^*,\quad s \in T_h(0, t),
$$
где
$$
    c'(t) = \int_{t}^{t+h} c'F(T,\theta)B\,d\theta ,
    $$
$$
    g^* = g - \Phi(t)x_0 - \gamma(t).
    $$

Таким образом, для решения задачи ЛП получим следующие данные:
\begin{equation*}
  {\bf A} = \left(
\begin{array}{ccccc}
  G & 0 & 0 & \ldots & 0 \\
  D(h,0) & G & 0 & \ldots & 0 \\
  D(2h,0) & D(2h,h) & G & \ldots & 0 \\
  \vdots & \vdots & \vdots & \ddots & \vdots \\
  D(T - h,0) & D(T - h,h) & \ldots & D(T - h,T - 2h) & G
\end{array}
\right)
\end{equation*}

\begin{equation*}
  {\bf u} = \left(
\begin{array}{c}
  u(0) \\
  u(h) \\
  u(2h) \\
  \vdots \\
  u(T-h)
\end{array}
\right)
\end{equation*}

\begin{equation*}
  {\bf b} = \left(
\begin{array}{c}
  g - \Phi(0)x_0 - \gamma(0) \\
  g - \Phi(h)x_0 - \gamma(h)\\
  g - \Phi(2h)x_0 - \gamma(2h)\\
  \vdots \\
  g - \Phi(T - h)x_0 - \gamma(T - h)
\end{array}
\right)
\end{equation*}


В итоге задачу ЛП (\ref{2.9}) перепишем  в виде:

\begin{equation*}
\sum_{t \in T_h}^{}{\bf c'}{\bf u} \to \min,
\end{equation*}
$${\bf A}{\bf u} \leq {\bf b},$$
$${\bf u} \in U\times U\times \ldots \times U,\quad t \in [0, T],$$



В данной главе была рассмотрена формулировка задачи оптимального управления для модели расширяющейся экономики фон Неймана,а так же описаны особенности задачи. Был рассмотрен подход к решению задачи оптимального управления линейной динамической системой с возмущениями и смешанными ограничениями.